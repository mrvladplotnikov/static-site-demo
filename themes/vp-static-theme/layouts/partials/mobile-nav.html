{{- $page := .context }}

<div id="mobile-nav" class="mobile-nav {{ .className }}">
  <a href={{ relLangURL "/" }} aria-label="Головна сторінка" class="mobile-nav-logo">
    <img src="/images/header-logo.svg" alt="">
  </a>

  <button type="button" id="mobile-menu-button" class="mobile-menu-btn" aria-expanded="false" aria-haspopup="dialog"
    aria-controls="mobile-menu-dialog" aria-label="Відкрити навігаційне меню сайту">
    <span class="mobile-menu-btn-line" aria-hidden="true"></span>
    <span class="mobile-menu-btn-line" aria-hidden="true"></span>
    <span class="mobile-menu-btn-line" aria-hidden="true"></span>
  </button>


  <div id="mobile-menu-dialog" role="dialog" aria-modal="true" class="mobile-menu" aria-label="Меню навігації по сайту"
    data-modal-till="768px" inert>

    {{- with index .context.Site.Menus "main" }}
    <nav class="mobile-menu-nav" aria-label="Список сторінок">
      <ul>
        {{- partial "inline/mobile-menu/walk.html" (dict "page" $page "menuEntries" .) }}
      </ul>
    </nav>
    {{- end }}

    {{- partial "langs-list-h.html" .context -}}
    <ul class="soc-links-list" aria-label="Посилання на соціальні мережі">
      {{ range .context.Site.Data.SocialLinks }}
      <li>
        <a class="no-external-icon no-hover" href="{{ .link }}" title="{{ .title }}" target="_blank"
          rel="noopener noreferrer nofollow">
          {{ $path := printf "icons/%s-icon.html" .icon }}
          {{- partial $path . -}}
        </a>
      </li>
      {{- end }}
    </ul>
  </div>
</div>

{{- define "partials/inline/mobile-menu/walk.html" }}
{{- $page := .page }}
{{- range .menuEntries }}
{{- $attrs := dict "href" .URL }}
{{- if $page.IsMenuCurrent .Menu . }}
{{- $attrs = merge $attrs (dict "aria-current" "page") }}
{{- else if $page.HasMenuCurrent .Menu .}}
{{- $attrs = merge $attrs (dict "aria-current" "true") }}
{{- end }}
{{- $name := .Name }}
{{- with .Identifier }}
{{- with T . }}
{{- $name = . }}
{{- end }}
{{- end }}
{{- with .Children }}
<li>
  <details>
    <summary class="mobile-menu-summary vp-hover">Послуги {{- partial "icons/arrow-down.html" . -}}</summary>
    <ul>
      {{- partial "inline/mobile-menu/walk.html" (dict "page" $page "menuEntries" .) }}
    </ul>
  </details>
</li>
{{- else }}
<li>
  <a {{- range $k, $v :=$attrs }} {{- with $v }} {{- printf " %s=%q" $k $v | safeHTMLAttr }} {{- end }} {{- end -}}
    class="mobile-menu-link">
    {{ $name }}
    <span class="mobile-menu-link-arrow" aria-hidden="true"></span>
  </a>
</li>
{{- end }}
{{- end }}
{{- end }}